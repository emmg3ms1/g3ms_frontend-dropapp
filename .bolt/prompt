BACKEND API DOCS JSON
{"openapi":"3.0.0","paths":{"/api/v1/users/me":{"get":{"description":"Retrieve the authenticated user's profile information.","operationId":"UserController_getCurrentUser","parameters":[],"responses":{"200":{"description":"User profile retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"id":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000"},"email":{"type":"string","example":"john.doe@example.com"},"firstName":{"type":"string","example":"John"},"lastName":{"type":"string","example":"Doe"},"role":{"type":"string","enum":["student","educator","brand","creator","ambassador","parent"],"example":"student"},"onboardingState":{"type":"string","enum":["PENDING_ROLE","PENDING_BIRTHDATE","PENDING_PHONE_VERIFICATION","PENDING_GUARDIAN_APPROVAL","READY"],"example":"READY"},"phoneVerified":{"type":"boolean","example":true},"profileImageUrl":{"type":"string","example":"https://example.com/avatar.jpg"},"createdAt":{"type":"string","example":"2024-01-15T10:30:00.000Z"},"updatedAt":{"type":"string","example":"2024-01-15T10:30:00.000Z"}}}}}},"401":{"description":"Invalid or missing token"}},"security":[{"bearer":[]}],"summary":"Get current user profile","tags":["Users"]}},"/api/v1/users":{"get":{"description":"Retrieve a paginated list of all users. Only accessible by super_admin and educator roles.","operationId":"UserController_getAllUsers","parameters":[{"name":"page","required":false,"in":"query","description":"Page number for pagination (starts from 1)","schema":{"minimum":1,"default":1,"example":1,"type":"integer"}},{"name":"limit","required":false,"in":"query","description":"Number of items per page (maximum 100)","schema":{"minimum":1,"maximum":100,"default":10,"example":10,"type":"integer"}}],"responses":{"200":{"description":"Users retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000"},"email":{"type":"string","example":"john.doe@example.com"},"firstName":{"type":"string","example":"John"},"lastName":{"type":"string","example":"Doe"},"role":{"type":"string","enum":["student","educator","brand","creator","ambassador","parent"],"example":"student"},"onboardingState":{"type":"string","enum":["PENDING_ROLE","PENDING_BIRTHDATE","PENDING_PHONE_VERIFICATION","PENDING_GUARDIAN_APPROVAL","READY"],"example":"READY"},"phoneVerified":{"type":"boolean","example":true},"profileImageUrl":{"type":"string","example":"https://example.com/avatar.jpg"},"createdAt":{"type":"string","example":"2024-01-15T10:30:00.000Z"},"updatedAt":{"type":"string","example":"2024-01-15T10:30:00.000Z"}}}},"meta":{"type":"object","properties":{"total":{"type":"number","example":150},"page":{"type":"number","example":1},"limit":{"type":"number","example":10},"totalPages":{"type":"number","example":15}}}}}}}},"401":{"description":"Invalid or missing token"},"403":{"description":"Insufficient permissions (requires super_admin or educator role)"}},"security":[{"bearer":[]}],"summary":"Get all users (Admin/Educator only)","tags":["Users"]}},"/api/v1/auth/register":{"post":{"description":"Create a new user account with email and password using Supabase Auth.","operationId":"AuthController_register","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegisterDto"}}}},"responses":{"201":{"description":"User registered successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Registration successful"},"user":{"type":"object","properties":{"id":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000"},"email":{"type":"string","example":"john.doe@example.com"},"onboardingState":{"type":"string","example":"PENDING_ROLE"},"createdAt":{"type":"string","example":"2024-01-15T10:30:00.000Z"}}},"session":{"type":"object","properties":{"access_token":{"type":"string","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."},"refresh_token":{"type":"string","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."},"expires_in":{"type":"number","example":3600},"token_type":{"type":"string","example":"bearer"}}}}}}}},"400":{"description":"Invalid input data"},"409":{"description":"Email already exists"}},"summary":"Register new user","tags":["Authentication"]}},"/api/v1/auth/login":{"post":{"description":"Authenticate user with email and password using Supabase Auth.","operationId":"AuthController_login","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginDto"}}}},"responses":{"200":{"description":"User logged in successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Login successful"},"user":{"type":"object","properties":{"id":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000"},"email":{"type":"string","example":"john.doe@example.com"},"role":{"type":"string","example":"student"},"onboardingState":{"type":"string","example":"READY"}}},"session":{"type":"object","properties":{"access_token":{"type":"string","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."},"refresh_token":{"type":"string","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."},"expires_in":{"type":"number","example":3600}}}}}}}},"400":{"description":"Invalid input data"},"401":{"description":"Invalid credentials"}},"summary":"Login user","tags":["Authentication"]}},"/api/v1/auth/logout":{"post":{"description":"Logout user and invalidate Supabase session.","operationId":"AuthController_logout","parameters":[{"name":"authorization","required":true,"in":"header","schema":{"type":"string"}}],"responses":{"200":{"description":"User logged out successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Logout successful"}}}}}},"401":{"description":"Invalid or missing token"}},"security":[{"bearer":[]}],"summary":"Logout user","tags":["Authentication"]}},"/api/v1/auth/refresh":{"post":{"description":"Get a new access token using refresh token.","operationId":"AuthController_refreshToken","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RefreshTokenDto"}}}},"responses":{"200":{"description":"Token refreshed successfully","content":{"application/json":{"schema":{"type":"object","properties":{"session":{"type":"object","properties":{"access_token":{"type":"string","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."},"refresh_token":{"type":"string","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."},"expires_in":{"type":"number","example":3600}}}}}}}},"401":{"description":"Invalid refresh token"}},"summary":"Refresh access token","tags":["Authentication"]}},"/api/v1/auth/google/url":{"post":{"description":"Generate Google OAuth URL for authentication.","operationId":"AuthController_getGoogleAuthUrl","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GoogleAuthUrlDto"}}}},"responses":{"200":{"description":"Google OAuth URL generated successfully","content":{"application/json":{"schema":{"type":"object","properties":{"url":{"type":"string","example":"https://accounts.google.com/oauth/authorize?client_id=..."},"provider":{"type":"string","example":"google"}}}}}},"400":{"description":"Invalid redirect URL"}},"summary":"Get Google OAuth URL","tags":["Authentication"]}},"/api/v1/auth/google/callback":{"post":{"description":"Handle the callback from Google OAuth and complete authentication.","operationId":"AuthController_handleGoogleCallback","parameters":[],"responses":{"200":{"description":"Google authentication completed successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Google authentication successful"},"user":{"type":"object","properties":{"id":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000"},"email":{"type":"string","example":"john.doe@gmail.com"},"firstName":{"type":"string","example":"John"},"lastName":{"type":"string","example":"Doe"},"profileImageUrl":{"type":"string","example":"https://lh3.googleusercontent.com/..."}}},"session":{"type":"object","properties":{"access_token":{"type":"string","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."},"refresh_token":{"type":"string","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."}}}}}}}},"401":{"description":"Google authentication failed"}},"summary":"Handle Google OAuth callback","tags":["Authentication"]}},"/api/v1/auth/google":{"post":{"description":"Authenticate user using Google OAuth access token.","operationId":"AuthController_continueWithGoogle","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GoogleAuthDto"}}}},"responses":{"200":{"description":"Google authentication successful","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Google authentication successful"},"user":{"type":"object","properties":{"id":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000"},"email":{"type":"string","example":"john.doe@gmail.com"},"firstName":{"type":"string","example":"John"},"lastName":{"type":"string","example":"Doe"},"profileImageUrl":{"type":"string","example":"https://lh3.googleusercontent.com/..."}}},"session":{"type":"object","properties":{"access_token":{"type":"string","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."},"refresh_token":{"type":"string","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."}}}}}}}},"400":{"description":"Invalid Google access token"},"401":{"description":"Google authentication failed"}},"summary":"Continue with Google","tags":["Authentication"]}},"/api/v1/auth/apple/url":{"post":{"description":"Generate Apple OAuth URL for authentication.","operationId":"AuthController_getAppleAuthUrl","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AppleAuthUrlDto"}}}},"responses":{"200":{"description":"Apple OAuth URL generated successfully","content":{"application/json":{"schema":{"type":"object","properties":{"url":{"type":"string","example":"https://appleid.apple.com/auth/authorize?client_id=..."},"provider":{"type":"string","example":"apple"}}}}}},"400":{"description":"Invalid redirect URL"}},"summary":"Get Apple OAuth URL","tags":["Authentication"]}},"/api/v1/auth/apple/callback":{"post":{"description":"Handle the callback from Apple OAuth and complete authentication.","operationId":"AuthController_handleAppleCallback","parameters":[],"responses":{"200":{"description":"Apple authentication completed successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Apple authentication successful"},"user":{"type":"object","properties":{"id":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000"},"email":{"type":"string","example":"john.doe@icloud.com"},"firstName":{"type":"string","example":"John"},"lastName":{"type":"string","example":"Doe"},"profileImageUrl":{"type":"string","example":"https://example.com/avatar.jpg"}}},"session":{"type":"object","properties":{"access_token":{"type":"string","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."},"refresh_token":{"type":"string","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."}}}}}}}},"401":{"description":"Apple authentication failed"}},"summary":"Handle Apple OAuth callback","tags":["Authentication"]}},"/api/v1/auth/apple":{"post":{"description":"Authenticate user using Apple OAuth access token.","operationId":"AuthController_continueWithApple","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AppleAuthDto"}}}},"responses":{"200":{"description":"Apple authentication successful","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Apple authentication successful"},"user":{"type":"object","properties":{"id":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000"},"email":{"type":"string","example":"john.doe@icloud.com"},"firstName":{"type":"string","example":"John"},"lastName":{"type":"string","example":"Doe"},"profileImageUrl":{"type":"string","example":"https://example.com/avatar.jpg"}}},"session":{"type":"object","properties":{"access_token":{"type":"string","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."},"refresh_token":{"type":"string","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."}}}}}}}},"400":{"description":"Invalid Apple access token"},"401":{"description":"Apple authentication failed"}},"summary":"Continue with Apple","tags":["Authentication"]}},"/api/v1/auth/classlink/url":{"post":{"description":"Generate ClassLink OAuth URL for authentication.","operationId":"AuthController_getClassLinkAuthUrl","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ClassLinkAuthUrlDto"}}}},"responses":{"200":{"description":"ClassLink OAuth URL generated successfully","content":{"application/json":{"schema":{"type":"object","properties":{"url":{"type":"string","example":"https://launchpad.classlink.com/oauth2/v2/auth?client_id=..."},"provider":{"type":"string","example":"classlink"}}}}}},"400":{"description":"Invalid redirect URL"}},"summary":"Get ClassLink OAuth URL","tags":["Authentication"]}},"/api/v1/auth/classlink/callback":{"post":{"description":"Handle the callback from ClassLink OAuth and complete authentication.","operationId":"AuthController_handleClassLinkCallback","parameters":[],"responses":{"200":{"description":"ClassLink authentication completed successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"ClassLink authentication successful"},"user":{"type":"object","properties":{"id":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000"},"email":{"type":"string","example":"john.doe@school.edu"},"firstName":{"type":"string","example":"John"},"lastName":{"type":"string","example":"Doe"},"profileImageUrl":{"type":"string","example":"https://example.com/avatar.jpg"}}},"session":{"type":"object","properties":{"access_token":{"type":"string","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."},"refresh_token":{"type":"string","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."}}}}}}}},"401":{"description":"ClassLink authentication failed"}},"summary":"Handle ClassLink OAuth callback","tags":["Authentication"]},"get":{"description":"Process the callback from ClassLink OAuth and complete authentication.","operationId":"AuthController_handleClassLinkOAuthCallback","parameters":[{"name":"code","required":true,"in":"query","schema":{"type":"string"}},{"name":"state","required":true,"in":"query","schema":{"type":"string"}}],"responses":{"302":{"description":"Redirect to frontend with authentication result"}},"summary":"Handle ClassLink OAuth callback","tags":["Authentication"]}},"/api/v1/auth/classlink":{"post":{"description":"Authenticate user using ClassLink OAuth access token.","operationId":"AuthController_continueWithClassLink","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ClassLinkAuthDto"}}}},"responses":{"200":{"description":"ClassLink authentication successful","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"ClassLink authentication successful"},"user":{"type":"object","properties":{"id":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000"},"email":{"type":"string","example":"john.doe@school.edu"},"firstName":{"type":"string","example":"John"},"lastName":{"type":"string","example":"Doe"},"profileImageUrl":{"type":"string","example":"https://example.com/avatar.jpg"}}},"session":{"type":"object","properties":{"access_token":{"type":"string","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."},"refresh_token":{"type":"string","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."}}}}}}}},"400":{"description":"Invalid ClassLink access token"},"401":{"description":"ClassLink authentication failed"}},"summary":"Continue with ClassLink","tags":["Authentication"]}},"/api/v1/auth/classlink/start":{"get":{"description":"Redirect user to ClassLink for authentication.","operationId":"AuthController_startClassLinkAuth","parameters":[],"responses":{"302":{"description":"Redirect to ClassLink OAuth"}},"summary":"Start ClassLink OAuth flow","tags":["Authentication"]}},"/api/v1/videos/upload-url":{"get":{"description":"Generate a signed upload URL for video upload to Mux.\n    \n    **Authorization:**\n    - **Super Admin**: Can generate upload URLs\n    - **Educator**: Can generate upload URLs for educational content\n    - **Brand**: Can generate upload URLs for brand content\n    - **Creator**: Can generate upload URLs for creative content\n    \n    **Usage Flow:**\n    1. Call this endpoint to get a signed upload URL\n    2. Use the returned URL to upload video directly to Mux from frontend\n    3. After successful upload, call the complete-upload endpoint with the asset ID\n    \n    **Frontend Integration:**\n    Use the returned URL with Mux's uploader component or direct HTTP upload.","operationId":"VideoController_getUploadUrl","parameters":[],"responses":{"200":{"description":"Upload URL generated successfully","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"object","properties":{"id":{"type":"string","example":"upload_1234567890"},"url":{"type":"string","example":"https://storage.googleapis.com/mux-uploads"},"timeout":{"type":"number","example":604800},"status":{"type":"string","example":"waiting"},"cors_origin":{"type":"string","example":"*"},"new_asset_settings":{"type":"object","properties":{"playback_policy":{"type":"array","items":{"type":"string"},"example":["public"]}}}}}}}}}},"403":{"description":"Insufficient permissions to upload videos"},"500":{"description":"Failed to generate upload URL"}},"security":[{"bearer":[]}],"summary":"Get Mux upload URL","tags":["Videos"]}},"/api/v1/videos/complete-upload":{"post":{"description":"Complete the video upload process by providing the Mux asset ID.\n    \n    **Authorization:**\n    - **Super Admin**: Can complete any video upload\n    - **Educator**: Can complete uploads for educational content\n    - **Brand**: Can complete uploads for brand content\n    - **Creator**: Can complete uploads for creative content\n    \n    **Usage Flow:**\n    1. After successful upload to Mux, you'll receive an asset ID\n    2. Call this endpoint with the asset ID to create a video record in the database\n    3. The video will be available for use in drops and other content\n    \n    **Asset Processing:**\n    - Retrieves asset details from Mux\n    - Creates video record in database\n    - Associates video with the authenticated user","operationId":"VideoController_completeUpload","parameters":[],"requestBody":{"required":true,"description":"Asset ID and optional title for the uploaded video","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CompleteUploadDto"}}}},"responses":{"200":{"description":"Video upload completed successfully","content":{"application/json":{"schema":{"type":"object","properties":{"id":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000"},"assetId":{"type":"string","example":"mux_asset_123"},"playbackId":{"type":"string","example":"playback_123"},"title":{"type":"string","example":"My Educational Video"},"userId":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000"},"createdAt":{"type":"string","example":"2024-01-15T10:30:00.000Z"},"updatedAt":{"type":"string","example":"2024-01-15T10:30:00.000Z"}}}}}},"403":{"description":"Insufficient permissions to complete upload"},"500":{"description":"Failed to process uploaded video"}},"security":[{"bearer":[]}],"summary":"Complete video upload","tags":["Videos"]}},"/api/v1/videos":{"get":{"description":"Retrieve a list of videos based on user permissions.\n    \n    Authorization & Filtering:\n    - **Super Admin**: Can see all videos in the system\n    - **Other Roles**: Can only see videos they uploaded\n    \n    **Response Data:**\n    - Video metadata (ID, title, asset ID, playback ID)\n    - Upload timestamps\n    - Creator information\n    - Sorted by creation date (newest first)","operationId":"VideoController_findAllVideos","parameters":[{"name":"page","required":false,"in":"query","description":"Page number for pagination (starts from 1)","schema":{"minimum":1,"default":1,"example":1,"type":"integer"}},{"name":"limit","required":false,"in":"query","description":"Number of items per page (maximum 100)","schema":{"minimum":1,"maximum":100,"default":10,"example":10,"type":"integer"}},{"name":"search","required":false,"in":"query","description":"Search term to filter results","schema":{"type":"string"}},{"name":"orderBy","required":false,"in":"query","description":"Field to sort by","schema":{"type":"string"}},{"name":"order","required":false,"in":"query","description":"Sort order","schema":{"example":"desc","type":"string","enum":["asc","desc"]}},{"name":"title","required":false,"in":"query","description":"Filter videos by title","schema":{"example":"Introduction to Algebra","type":"string"}},{"name":"userId","required":false,"in":"query","description":"Filter videos by user ID","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}},{"name":"status","required":false,"in":"query","description":"Filter videos by status","schema":{"example":"READY","type":"string","enum":["PENDING","PROCESSING","PENDING_REVIEW","READY","FAILED"]}},{"name":"type","required":false,"in":"query","description":"Filter videos by type","schema":{"example":"DROP_VIDEO","type":"string","enum":["DROP_VIDEO","DROP_RESPONSE"]}},{"name":"domainId","required":false,"in":"query","description":"Filter videos by domain ID","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}}],"responses":{"200":{"description":"Videos retrieved successfully","content":{"application/json":{"schema":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000"},"title":{"type":"string","example":"My Educational Video"},"assetId":{"type":"string","example":"mux_asset_123"},"playbackId":{"type":"string","example":"playback_123"},"createdAt":{"type":"string","example":"2024-01-15T10:30:00.000Z"},"updatedAt":{"type":"string","example":"2024-01-15T10:30:00.000Z"},"user":{"type":"object","properties":{"id":{"type":"string"},"email":{"type":"string"},"firstName":{"type":"string"},"lastName":{"type":"string"}}}}}}}}}},"security":[{"bearer":[]}],"summary":"Get all videos","tags":["Videos"]}},"/api/v1/videos/{id}":{"get":{"description":"Retrieve detailed information about a specific video.\n    \n    **Authorization:**\n    - **Super Admin**: Can access any video\n    - **Other Roles**: Can only access videos they uploaded\n    \n    **Response Data:**\n    - Complete video details including asset metadata\n    - Creator information\n    - Upload and processing status","operationId":"VideoController_findVideoById","parameters":[{"name":"id","required":true,"in":"path","description":"Video ID (UUID)","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}}],"responses":{"200":{"description":"Video retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"id":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000"},"title":{"type":"string","example":"My Educational Video"},"assetId":{"type":"string","example":"mux_asset_123"},"playbackId":{"type":"string","example":"playback_123"},"assetDetails":{"type":"object","description":"Mux asset metadata"},"userId":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000"},"createdAt":{"type":"string","example":"2024-01-15T10:30:00.000Z"},"updatedAt":{"type":"string","example":"2024-01-15T10:30:00.000Z"},"user":{"type":"object","properties":{"id":{"type":"string"},"email":{"type":"string"},"firstName":{"type":"string"},"lastName":{"type":"string"}}}}}}}},"403":{"description":"Insufficient permissions to access this video"},"404":{"description":"Video not found"}},"security":[{"bearer":[]}],"summary":"Get video by ID","tags":["Videos"]}},"/api/v1/admin/drops":{"post":{"description":"Create a new educational drop with video content and quiz template. \n    \n    **Authorization:**\n    - **Super Admin**: Can create drops for any school/brand\n    - **Educator**: Can create drops for their associated school\n    - **Brand**: Can create drops for their own brand (must set brandId)\n    - **Creator**: Can create general drops\n    \n    **Drop Types:**\n    - **BELLWORK_EXIT_TICKETS**: Quick assessment at start/end of class\n    - **KNOWLEDGE_CHECK_QUIZ**: Formal knowledge assessment\n    - **SCAFFOLDED_LESSON**: Step-by-step guided learning\n    - **VIDEO_BASED_INSTRUCTION**: Video-centric learning experience\n    - **PROJECT_BASED_LEARNING**: Collaborative project work\n    - **FORMATIVE_ASSESSMENT**: Ongoing assessment during learning\n    \n    **Brand Drops:**\n    Brand users must provide a brandId and can only publish after adding appropriate rewards.","operationId":"DropAdminController_createDrop","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateDropDto"}}}},"responses":{"201":{"description":"Drop created successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Drop created successfully"},"drop":{"type":"object","properties":{"id":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000"},"title":{"type":"string","example":"Advanced Algebra: Quadratic Equations Mastery"},"dropType":{"type":"string","enum":["BELLWORK_EXIT_TICKETS","KNOWLEDGE_CHECK_QUIZ","SCAFFOLDED_LESSON","VIDEO_BASED_INSTRUCTION","PROJECT_BASED_LEARNING","FORMATIVE_ASSESSMENT"]},"status":{"type":"string","enum":["DRAFT","SCHEDULED","LIVE","ENDED","ARCHIVED","CANCELLED"]},"scheduledAt":{"type":"string","example":"2024-02-15T17:00:00.000Z"},"isPublished":{"type":"boolean","example":false},"createdBy":{"type":"object","properties":{"id":{"type":"string"},"email":{"type":"string"},"firstName":{"type":"string"},"lastName":{"type":"string"},"role":{"type":"string"}}}}}}}}}},"400":{"description":"Invalid input data or scheduling conflict"},"403":{"description":"Insufficient permissions"},"404":{"description":"Video, template, school, or grade not found"},"409":{"description":"Scheduling conflict with existing drop"}},"security":[{"bearer":[]}],"summary":"Create and Schedule a New Drop","tags":["Drops (Admin)"]},"get":{"description":"Retrieve a paginated list of drops with comprehensive filtering options.\n    \n    **Authorization & Filtering:**\n    - **Super Admin**: Can see all drops\n    - **Educator**: Can see drops for their school\n    - **Brand**: Can see only their brand drops\n    - **Creator**: Can see drops they created\n    \n    **Available Filters:**\n    - Status (draft, scheduled, live, ended, archived, cancelled)\n    - Drop type (bellwork, quiz, lesson, etc.)\n    - Audience type (all users, premium only, free only)\n    - School and grade targeting\n    - Date range for scheduling\n    - Search by title, subject, or learning goal\n    - Published status\n    \n    **Sorting:** Results are sorted by scheduled date (newest first)","operationId":"DropAdminController_findAllDrops","parameters":[{"name":"page","required":false,"in":"query","description":"Page number for pagination (starts from 1)","schema":{"minimum":1,"default":1,"example":1,"type":"integer"}},{"name":"limit","required":false,"in":"query","description":"Number of items per page (maximum 100)","schema":{"minimum":1,"maximum":100,"default":10,"example":10,"type":"integer"}},{"name":"status","required":false,"in":"query","description":"Filter drops by status","schema":{"example":"LIVE","type":"string","enum":["DRAFT","SCHEDULED","LIVE","ENDED","ARCHIVED","CANCELLED"]}},{"name":"dropType","required":false,"in":"query","description":"Filter drops by type","schema":{"example":"KNOWLEDGE_CHECK_QUIZ","type":"string","enum":["BELLWORK_EXIT_TICKETS","KNOWLEDGE_CHECK_QUIZ","SCAFFOLDED_LESSON","VIDEO_BASED_INSTRUCTION","PROJECT_BASED_LEARNING","FORMATIVE_ASSESSMENT"]}},{"name":"schoolId","required":false,"in":"query","description":"Filter drops by school ID","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}},{"name":"gradeId","required":false,"in":"query","description":"Filter drops by grade ID","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}},{"name":"createdBy","required":false,"in":"query","description":"Filter drops by creator user ID","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}},{"name":"brandId","required":false,"in":"query","description":"Filter drops by brand ID","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}},{"name":"subject","required":false,"in":"query","description":"Filter drops by subject","schema":{"example":"Mathematics","type":"string"}},{"name":"rtiTier","required":false,"in":"query","description":"Filter drops by RTI tier","schema":{"example":"Tier 1","type":"string"}},{"name":"scheduledFrom","required":false,"in":"query","description":"Filter drops scheduled from this date (ISO 8601)","schema":{"example":"2024-02-01T00:00:00.000Z","type":"string"}},{"name":"scheduledTo","required":false,"in":"query","description":"Filter drops scheduled until this date (ISO 8601)","schema":{"example":"2024-02-28T23:59:59.000Z","type":"string"}},{"name":"isPublished","required":false,"in":"query","description":"Filter drops by published status","schema":{"example":true,"type":"boolean"}},{"name":"search","required":false,"in":"query","description":"Search drops by title or learning goal","schema":{"example":"algebra","type":"string"}}],"responses":{"200":{"description":"Drops retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"title":{"type":"string"},"dropType":{"type":"string","enum":["BELLWORK_EXIT_TICKETS","KNOWLEDGE_CHECK_QUIZ","SCAFFOLDED_LESSON","VIDEO_BASED_INSTRUCTION","PROJECT_BASED_LEARNING","FORMATIVE_ASSESSMENT"]},"status":{"type":"string","enum":["DRAFT","SCHEDULED","LIVE","ENDED","ARCHIVED","CANCELLED"]},"scheduledAt":{"type":"string"},"isPublished":{"type":"boolean"},"subject":{"type":"string"},"rtiTier":{"type":"string"},"learningGoal":{"type":"string"},"createdBy":{"type":"object"},"brand":{"type":"object"},"schools":{"type":"array"},"grades":{"type":"array"},"reward":{"type":"object"},"_count":{"type":"object","properties":{"responses":{"type":"number"}}}}}},"meta":{"type":"object","properties":{"total":{"type":"number","example":150},"page":{"type":"number","example":1},"limit":{"type":"number","example":10},"totalPages":{"type":"number","example":15}}}}}}}},"403":{"description":"Insufficient permissions"}},"security":[{"bearer":[]}],"summary":"List All Drops with Filtering and Pagination","tags":["Drops (Admin)"]}},"/api/v1/admin/drops/{id}":{"get":{"description":"Retrieve detailed information about a specific drop including all related data.\n    \n    **Authorization:**\n    - Users can only access drops they created or have permission to view\n    - Super admins can access any drop\n    - Brand users can access drops for their brand\n    \n    **Includes:**\n    - Video and template details\n    - Creator and brand information\n    - School and grade targeting\n    - Reward configuration\n    - Student responses (for authorized users)","operationId":"DropAdminController_findDropById","parameters":[{"name":"id","required":true,"in":"path","description":"Drop ID (UUID)","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}}],"responses":{"200":{"description":"Drop retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"id":{"type":"string"},"title":{"type":"string"},"dropType":{"type":"string","enum":["BELLWORK_EXIT_TICKETS","KNOWLEDGE_CHECK_QUIZ","SCAFFOLDED_LESSON","VIDEO_BASED_INSTRUCTION","PROJECT_BASED_LEARNING","FORMATIVE_ASSESSMENT"]},"status":{"type":"string","enum":["DRAFT","SCHEDULED","LIVE","ENDED","ARCHIVED","CANCELLED"]},"scheduledAt":{"type":"string"},"isPublished":{"type":"boolean"},"video":{"type":"object"},"template":{"type":"object"},"createdBy":{"type":"object"},"brand":{"type":"object"},"schools":{"type":"array"},"grades":{"type":"array"},"reward":{"type":"object"},"responses":{"type":"array"}}}}}},"403":{"description":"Insufficient permissions to access this drop"},"404":{"description":"Drop not found"}},"security":[{"bearer":[]}],"summary":"Get Drop by ID","tags":["Drops (Admin)"]},"patch":{"description":"Update an existing drop with new information.\n    \n    **Authorization:**\n    - Users can only update drops they created\n    - Super admins can update any drop\n    - Brand users can update drops for their brand\n    \n    **Restrictions:**\n    - Cannot update drops that are live, ended, or archived\n    - Scheduling conflicts are checked if scheduledAt is updated\n    - All related entities are validated if updated\n    \n    **Partial Updates:**\n    All fields are optional - only provided fields will be updated.","operationId":"DropAdminController_updateDrop","parameters":[{"name":"id","required":true,"in":"path","description":"Drop ID (UUID)","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateDropDto"}}}},"responses":{"200":{"description":"Drop updated successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Drop updated successfully"},"drop":{"type":"object"}}}}}},"400":{"description":"Cannot update live, ended, or archived drops"},"403":{"description":"Insufficient permissions to update this drop"},"404":{"description":"Drop not found"},"409":{"description":"Scheduling conflict with existing drop"}},"security":[{"bearer":[]}],"summary":"Update Drop","tags":["Drops (Admin)"]}},"/api/v1/admin/drops/{id}/publish":{"post":{"description":"Control the published status of a drop.\n    \n    **Publishing Requirements:**\n    - Brand drops with brand rewards must have a reward item selected\n    - Published drops become visible to students\n    - Publishing a draft drop automatically changes status to scheduled\n    \n    **Authorization:**\n    - Users can only publish/unpublish drops they created\n    - Super admins can publish/unpublish any drop\n    - Brand users can publish/unpublish drops for their brand","operationId":"DropAdminController_publishDrop","parameters":[{"name":"id","required":true,"in":"path","description":"Drop ID (UUID)","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PublishDropDto"}}}},"responses":{"200":{"description":"Drop publish status updated successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Drop published successfully"},"drop":{"type":"object"}}}}}},"400":{"description":"Brand drops must have reward item before publishing"},"403":{"description":"Insufficient permissions to publish this drop"},"404":{"description":"Drop not found"}},"security":[{"bearer":[]}],"summary":"Publish or Unpublish Drop","tags":["Drops (Admin)"]}},"/api/v1/admin/drops/{id}/cancel":{"post":{"description":"Cancel a scheduled or draft drop.\n    \n    **Cancellation Rules:**\n    - Cannot cancel drops that are already ended, archived, or cancelled\n    - Cancelled drops are automatically unpublished\n    - Students will no longer see cancelled drops\n    \n    **Authorization:**\n    - Users can only cancel drops they created\n    - Super admins can cancel any drop\n    - Brand users can cancel drops for their brand\n    \n    **Effects:**\n    - Status changes to CANCELLED\n    - Drop becomes unpublished\n    - Students lose access to the drop","operationId":"DropAdminController_cancelDrop","parameters":[{"name":"id","required":true,"in":"path","description":"Drop ID (UUID)","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}}],"responses":{"200":{"description":"Drop cancelled successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Drop cancelled successfully"},"drop":{"type":"object"}}}}}},"400":{"description":"Cannot cancel drops that are already ended, archived, or cancelled"},"403":{"description":"Insufficient permissions to cancel this drop"},"404":{"description":"Drop not found"}},"security":[{"bearer":[]}],"summary":"Cancel Drop","tags":["Drops (Admin)"]}},"/api/v1/drops/for-learners":{"get":{"description":"Retrieve drops that learners can participate in, with real-time countdown for upcoming drops.\n    \n    **Drop Flow for Learners:**\n    1. **Watch** the educational video content\n    2. **Show** their thinking by recording video/audio/image response\n    3. **Quiz** by answering template questions\n    4. **Reward** by earning G3MS tokens or brand rewards\n    \n    **User Tier Restrictions:**\n    - **Free Users**: Can access ALL_USERS and FREE_ONLY drops, limited to 1 drop daily at 5 PM EST\n    - **Premium Users**: Can access ALL_USERS and PREMIUM_ONLY drops, unlimited participation\n    \n    **Drop States:**\n    - **Live Drops**: Currently active and accepting participation\n    - **Upcoming Drops**: Scheduled for future with countdown timer\n    - **Completed Drops**: Past drops (not included in this endpoint)\n    \n    **Countdown Information:**\n    - Real-time countdown in milliseconds and human-readable format\n    - Automatically updates as drops transition from upcoming to live\n    \n    **Participation Tracking:**\n    - Shows how many drops completed today\n    - Indicates if user can participate in more drops based on their tier","operationId":"LearnerDropController_getLiveAndUpcomingDrops","parameters":[],"responses":{"200":{"description":"Live and upcoming drops retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"liveDrops":{"type":"array","description":"Currently active drops that learners can participate in","items":{"type":"object","properties":{"id":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000"},"title":{"type":"string","example":"Advanced Algebra: Quadratic Equations"},"dropType":{"type":"string","enum":["BELLWORK_EXIT_TICKETS","KNOWLEDGE_CHECK_QUIZ","SCAFFOLDED_LESSON","VIDEO_BASED_INSTRUCTION","PROJECT_BASED_LEARNING","FORMATIVE_ASSESSMENT"],"example":"KNOWLEDGE_CHECK_QUIZ"},"subject":{"type":"string","example":"Mathematics"},"rtiTier":{"type":"string","example":"Tier 1"},"learningGoal":{"type":"string","example":"Students will solve quadratic equations using the quadratic formula"},"scheduledAt":{"type":"string","example":"2024-02-15T17:00:00.000Z"},"status":{"type":"string","enum":["DRAFT","SCHEDULED","LIVE","ENDED","ARCHIVED","CANCELLED"],"example":"LIVE"},"totalParticipants":{"type":"number","example":1247},"completionPercentage":{"type":"number","example":74},"video":{"type":"object","properties":{"id":{"type":"string"},"title":{"type":"string"},"playbackId":{"type":"string"}}},"template":{"type":"object","properties":{"id":{"type":"string"},"title":{"type":"string"},"type":{"type":"string"}}},"reward":{"type":"object","properties":{"rewardType":{"type":"string","enum":["G3MS","BRAND_REWARD"]},"g3msAmount":{"type":"number","example":50},"winnersCount":{"type":"number","example":5},"eligibilityText":{"type":"string","example":"Top 5 students with highest quiz scores"}}},"brand":{"type":"object","properties":{"id":{"type":"string"},"firstName":{"type":"string"},"lastName":{"type":"string"},"email":{"type":"string"}}}}}},"upcomingDrops":{"type":"array","description":"Scheduled drops with countdown information","items":{"type":"object","properties":{"id":{"type":"string"},"title":{"type":"string"},"dropType":{"type":"string","enum":["BELLWORK_EXIT_TICKETS","KNOWLEDGE_CHECK_QUIZ","SCAFFOLDED_LESSON","VIDEO_BASED_INSTRUCTION","PROJECT_BASED_LEARNING","FORMATIVE_ASSESSMENT"]},"scheduledAt":{"type":"string"},"status":{"type":"string","example":"SCHEDULED"},"countdownMs":{"type":"number","example":3600000,"description":"Milliseconds until drop starts"},"timeUntilStart":{"type":"string","example":"1h 0m","description":"Human readable countdown"},"video":{"type":"object"},"template":{"type":"object"},"reward":{"type":"object"}}}},"completedDropsToday":{"type":"number","example":1,"description":"Number of drops the user has completed today"},"canParticipateInMore":{"type":"boolean","example":true,"description":"Whether the user can participate in more drops based on their tier and daily limits"}}}}}},"401":{"description":"Authentication required"},"403":{"description":"User not found or insufficient permissions"}},"security":[{"bearer":[]}],"summary":"Get live and upcoming drops for learners","tags":["Drops (Learner)"]}},"/api/v1/drops/{id}/details":{"get":{"description":"Retrieve comprehensive details about a specific drop for learner participation.\n    \n    **Use Cases:**\n    - Display drop details before participation\n    - Show countdown for upcoming drops\n    - Provide context about the learning objectives\n    - Display reward information and eligibility\n    \n    **Authorization:**\n    - Drop must be published and accessible to the user's tier\n    - Respects audience type restrictions (FREE_ONLY, PREMIUM_ONLY, ALL_USERS)\n    \n    **Countdown Features:**\n    - Real-time countdown for scheduled drops\n    - Automatic status updates as drops go live\n    - Human-readable time formatting\n    \n    **Educational Context:**\n    - Learning goals and objectives\n    - Subject and RTI tier information\n    - Video content details\n    - Quiz template information","operationId":"LearnerDropController_getDropDetails","parameters":[{"name":"id","required":true,"in":"path","description":"Drop ID (UUID)","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}}],"responses":{"200":{"description":"Drop details retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"id":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000"},"title":{"type":"string","example":"Advanced Algebra: Quadratic Equations"},"dropType":{"type":"string","enum":["BELLWORK_EXIT_TICKETS","KNOWLEDGE_CHECK_QUIZ","SCAFFOLDED_LESSON","VIDEO_BASED_INSTRUCTION","PROJECT_BASED_LEARNING","FORMATIVE_ASSESSMENT"],"example":"KNOWLEDGE_CHECK_QUIZ"},"subject":{"type":"string","example":"Mathematics"},"rtiTier":{"type":"string","example":"Tier 1"},"learningGoal":{"type":"string","example":"Students will solve quadratic equations using the quadratic formula"},"scheduledAt":{"type":"string","example":"2024-02-15T17:00:00.000Z"},"status":{"type":"string","enum":["DRAFT","SCHEDULED","LIVE","ENDED","ARCHIVED","CANCELLED"],"example":"LIVE"},"countdownMs":{"type":"number","example":3600000,"description":"Only present for scheduled drops"},"timeUntilStart":{"type":"string","example":"1h 0m","description":"Only present for scheduled drops"},"totalParticipants":{"type":"number","example":1247},"completionPercentage":{"type":"number","example":74},"video":{"type":"object","properties":{"id":{"type":"string"},"title":{"type":"string"},"playbackId":{"type":"string","description":"Mux playback ID for video streaming"},"assetId":{"type":"string","description":"Mux asset ID"}}},"template":{"type":"object","properties":{"id":{"type":"string"},"title":{"type":"string"},"type":{"type":"string"}}},"reward":{"type":"object","properties":{"id":{"type":"string"},"rewardType":{"type":"string","enum":["G3MS","BRAND_REWARD"]},"g3msAmount":{"type":"number","example":50},"winnersCount":{"type":"number","example":5},"eligibilityText":{"type":"string","example":"Top 5 students with highest quiz scores"},"rewardItem":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"imageUrl":{"type":"string"},"g3msPrice":{"type":"number"}}}}},"brand":{"type":"object","properties":{"id":{"type":"string"},"firstName":{"type":"string"},"lastName":{"type":"string"},"email":{"type":"string"}}},"schools":{"type":"array","items":{"type":"object","properties":{"school":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"city":{"type":"string"},"state":{"type":"string"}}}}}},"grades":{"type":"array","items":{"type":"object","properties":{"grade":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"order":{"type":"number"}}}}}}}}}}},"403":{"description":"Drop not accessible to user or not published"},"404":{"description":"Drop not found"}},"security":[{"bearer":[]}],"summary":"Get detailed drop information for learners","tags":["Drops (Learner)"]}},"/api/v1/drops/{dropId}/media-response":{"post":{"description":"Submit a media response (text, image, audio, or video) to a live drop.\n    \n    **Prerequisites:**\n    - Drop must be published and in LIVE status\n    - User must not have already submitted a media response for this drop\n    \n    **Response Types:**\n    - **TEXT**: Provide textResponse field (max 2000 characters)\n    - **IMAGE**: Provide contentUrl with pre-uploaded image URL\n    - **AUDIO_NOTE**: Provide contentUrl with pre-uploaded audio URL\n    - **VIDEO**: Provide either uploadId (for new Mux upload) or videoId (for existing video)\n    \n    **Video Upload Flow:**\n    1. Request Mux upload URL from /videos/upload-url\n    2. Upload video directly to Mux from frontend\n    3. Submit uploadId in this endpoint\n    \n    **Next Steps:**\n    After successful media submission, the learner can start the quiz using the quiz endpoints.","operationId":"LearnerMediaResponseController_submitMediaResponse","parameters":[{"name":"dropId","required":true,"in":"path","description":"Drop ID (UUID)","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}}],"requestBody":{"required":true,"description":"Media response data","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateMediaResponseDto"}}}},"responses":{"200":{"description":"Media response submitted successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Media response submitted successfully"},"response":{"type":"object","properties":{"id":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000"},"responseType":{"type":"string","enum":["VIDEO","IMAGE","AUDIO_NOTE","TEXT"]},"textResponse":{"type":"string","example":"My thoughtful response..."},"contentUrl":{"type":"string","example":"https://storage.example.com/image.jpg"},"submittedAt":{"type":"string","example":"2024-01-15T10:30:00.000Z"},"drop":{"type":"object","properties":{"id":{"type":"string"},"title":{"type":"string"}}},"video":{"type":"object","properties":{"id":{"type":"string"},"title":{"type":"string"},"playbackId":{"type":"string"}}}}}}}}}},"400":{"description":"Invalid request data or drop not accepting responses"},"404":{"description":"Drop not found"},"409":{"description":"Media response already submitted for this drop"}},"security":[{"bearer":[]}],"summary":"Submit media response to a drop","tags":["Drops (Learner)"]}},"/api/v1/drops/{dropId}/quiz":{"post":{"description":"Handle quiz interactions for a drop based on the action parameter.\n    \n    **Action: start**\n    - Creates a new quiz session or returns existing session state\n    - Returns the first/current question\n    - Prerequisites: Media response must be submitted first\n    \n    **Action: submit**\n    - Submits an answer to the current question\n    - Returns answer feedback and next question (if any)\n    - Automatically completes quiz when all questions are answered\n    \n    **Quiz Flow:**\n    1. Submit media response first\n    2. Call with action=start to begin quiz\n    3. Answer questions one by one with action=submit\n    4. Quiz completes automatically after last question\n    5. Claim reward using reward endpoints","operationId":"LearnerQuizController_handleQuizAction","parameters":[{"name":"dropId","required":true,"in":"path","description":"Drop ID (UUID)","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}},{"name":"action","required":true,"in":"query","description":"Quiz action to perform","schema":{"enum":["start","submit"],"type":"string"}}],"requestBody":{"required":false,"description":"Quiz answer data (only required for action=submit)","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SubmitQuizAnswerDto"}}}},"responses":{"200":{"description":"Quiz action completed successfully","content":{"application/json":{"schema":{"oneOf":[{"title":"Start Quiz Response","type":"object","properties":{"quizSessionId":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000"},"currentQuestion":{"type":"object","properties":{"id":{"type":"string"},"question":{"type":"string"},"passage":{"type":"string"},"math":{"type":"string"},"questionMedia":{"type":"string"},"options":{"type":"object","properties":{"A":{"type":"string"},"B":{"type":"string"},"C":{"type":"string"},"D":{"type":"string"}}},"optionMedia":{"type":"object","properties":{"A":{"type":"string"},"B":{"type":"string"},"C":{"type":"string"},"D":{"type":"string"}}}}},"questionsAnswered":{"type":"number","example":0},"totalQuestions":{"type":"number","example":5},"quizCompleted":{"type":"boolean","example":false},"correctAnswers":{"type":"number","example":0}}},{"title":"Submit Answer Response","type":"object","properties":{"isCorrect":{"type":"boolean","example":true},"questionsAnswered":{"type":"number","example":1},"totalQuestions":{"type":"number","example":5},"correctAnswers":{"type":"number","example":1},"quizCompleted":{"type":"boolean","example":false},"newQuestion":{"type":"object","description":"Next question (null if quiz completed)"},"timeLeft":{"type":"number","description":"Time remaining (if applicable)"}}}]}}}},"400":{"description":"Invalid request or quiz state"},"404":{"description":"Drop or question not found"}},"security":[{"bearer":[]}],"summary":"Start quiz or submit quiz answer","tags":["Drops (Learner)"]}},"/api/v1/drops/{dropId}/reward":{"get":{"description":"Retrieve reward information for a drop after completing the quiz.\n    \n    **Prerequisites:**\n    - Media response must be submitted\n    - Quiz must be completed\n    \n    **Response includes:**\n    - Reward details (G3MS amount, store items, etc.)\n    - Quiz score and performance\n    - Claim status and eligibility\n    \n    **Reward Types:**\n    - **G3MS**: Token rewards added to user balance\n    - **BRAND_REWARD**: Physical items from brand partners","operationId":"LearnerRewardController_getRewardDetails","parameters":[{"name":"dropId","required":true,"in":"path","description":"Drop ID (UUID)","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}}],"responses":{"200":{"description":"Reward details retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"rewardDetails":{"type":"object","properties":{"id":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000"},"rewardType":{"type":"string","enum":["G3MS","BRAND_REWARD"]},"g3msAmount":{"type":"number","example":50},"winnersCount":{"type":"number","example":5},"eligibilityText":{"type":"string","example":"Top 5 students with highest quiz scores"},"rewardItem":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string","example":"Amazon Gift Card $25"},"imageUrl":{"type":"string"},"g3msPrice":{"type":"number"},"description":{"type":"string"}}}}},"isClaimed":{"type":"boolean","example":false},"claimable":{"type":"boolean","example":true},"quizScore":{"type":"object","properties":{"correctAnswers":{"type":"number","example":4},"totalQuestions":{"type":"number","example":5},"percentage":{"type":"number","example":80}}}}}}}},"400":{"description":"No response found or quiz not started"},"403":{"description":"Quiz must be completed to view reward details"},"404":{"description":"Drop not found"}},"security":[{"bearer":[]}],"summary":"Get reward details for a completed drop","tags":["Drops (Learner)"]}},"/api/v1/drops/{dropId}/reward/claim":{"post":{"description":"Claim the reward for a drop after completing the quiz.\n    \n    **Prerequisites:**\n    - Media response must be submitted\n    - Quiz must be completed\n    - Reward must not be already claimed\n    \n    **Reward Distribution:**\n    - G3MS tokens are added to user balance (future implementation)\n    - Store items are added to user inventory (future implementation)\n    - Notifications are sent (future implementation)\n    \n    **Note:** This endpoint marks the reward as claimed. Actual reward distribution\n    logic (updating balances, sending items) will be implemented in future phases.","operationId":"LearnerRewardController_claimReward","parameters":[{"name":"dropId","required":true,"in":"path","description":"Drop ID (UUID)","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}}],"responses":{"200":{"description":"Reward claimed successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Reward claimed successfully"},"rewardType":{"type":"string","enum":["G3MS","BRAND_REWARD"]},"g3msAmount":{"type":"number","example":50},"rewardItem":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"imageUrl":{"type":"string"},"g3msPrice":{"type":"number"}}}}}}}},"400":{"description":"Quiz not completed or reward already claimed"},"404":{"description":"Drop not found"}},"security":[{"bearer":[]}],"summary":"Claim reward for a completed drop","tags":["Drops (Learner)"]}},"/api/v1/onboarding/role":{"post":{"description":"Select user role and proceed to next onboarding step based on role.","operationId":"OnboardingController_setRole","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RoleSelectionDto"}}}},"responses":{"200":{"description":"Role set successfully","content":{"application/json":{"schema":{"type":"object","properties":{"state":{"type":"string","enum":["PENDING_BIRTHDATE","PENDING_PHONE_VERIFICATION"],"example":"PENDING_BIRTHDATE"}}}}}},"401":{"description":"Missing or invalid JWT"},"409":{"description":"Role already finalized"},"422":{"description":"Invalid role"}},"security":[{"bearer":[]}],"summary":"Set user role (first onboarding step)","tags":["Onboarding"]}},"/api/v1/onboarding/student/birthdate":{"post":{"description":"Set birthdate for student users. Age determines next step (phone verification or guardian approval).","operationId":"OnboardingController_setBirthdate","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BirthdateDto"}}}},"responses":{"200":{"description":"Birthdate set successfully","content":{"application/json":{"schema":{"type":"object","properties":{"state":{"type":"string","enum":["PENDING_PHONE_VERIFICATION","PENDING_GUARDIAN_INFO"],"example":"PENDING_PHONE_VERIFICATION"}}}}}},"401":{"description":"Missing or invalid JWT"},"409":{"description":"Birthdate already set"},"422":{"description":"Invalid date or future date"}},"security":[{"bearer":[]}],"summary":"Set student birthdate","tags":["Onboarding"]}},"/api/v1/onboarding/phone/send-otp":{"post":{"description":"Send verification code to phone number via SMS.","operationId":"OnboardingController_sendOtp","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SendOtpDto"}}}},"responses":{"200":{"description":"OTP sent successfully","content":{"application/json":{"schema":{"type":"object","properties":{"ok":{"type":"boolean","example":true}}}}}},"401":{"description":"Missing or invalid JWT"},"422":{"description":"Invalid phone number"},"429":{"description":"Rate limit exceeded"},"502":{"description":"SMS provider error"}},"security":[{"bearer":[]}],"summary":"Send OTP to phone number","tags":["Onboarding"]}},"/api/v1/onboarding/phone/verify":{"post":{"description":"Verify OTP code and complete phone verification.","operationId":"OnboardingController_verifyOtp","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/VerifyOtpDto"}}}},"responses":{"200":{"description":"Phone verified successfully","content":{"application/json":{"schema":{"type":"object","properties":{"state":{"type":"string","example":"READY"}}}}}},"400":{"description":"Wrong or expired code"},"401":{"description":"Missing or invalid JWT"},"409":{"description":"Phone belongs to another user"},"410":{"description":"Code already consumed"},"422":{"description":"Invalid payload"}},"security":[{"bearer":[]}],"summary":"Verify OTP code","tags":["Onboarding"]}},"/api/v1/onboarding/guardian":{"post":{"description":"Create guardian approval request and send SMS to parent.","operationId":"OnboardingController_createGuardianApproval","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GuardianApprovalDto"}}}},"responses":{"200":{"description":"Guardian approval request created","content":{"application/json":{"schema":{"type":"object","properties":{"state":{"type":"string","example":"READY"}}}}}},"401":{"description":"Missing or invalid JWT"},"422":{"description":"Invalid names or phone"},"429":{"description":"SMS rate limit exceeded"},"502":{"description":"SMS provider error"}},"security":[{"bearer":[]}],"summary":"Request guardian approval for under-13 students","tags":["Onboarding"]}},"/api/v1/onboarding/guardian/approve/{token}":{"get":{"description":"Public endpoint for parents to approve their child's account via SMS link.","operationId":"OnboardingController_approveGuardian","parameters":[{"name":"token","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Guardian approval completed","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Guardian approval completed successfully"}}}}}},"400":{"description":"Invalid or expired token"},"409":{"description":"Already approved"}},"summary":"Approve guardian request (public endpoint)","tags":["Onboarding"]}},"/api/v1/onboarding/status":{"get":{"description":"Retrieve the current onboarding state for the authenticated user.","operationId":"OnboardingController_getStatus","parameters":[],"responses":{"200":{"description":"Status retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"state":{"type":"string","enum":["PENDING_ROLE","PENDING_BIRTHDATE","PENDING_PHONE_VERIFICATION","PENDING_GUARDIAN_INFO","READY"],"example":"READY"}}}}}},"401":{"description":"Missing or invalid JWT"}},"security":[{"bearer":[]}],"summary":"Get current onboarding status","tags":["Onboarding"]}},"/api/v1/templates":{"get":{"description":"Retrieve a paginated list of templates with optional filtering and search.","operationId":"TemplateController_findAll","parameters":[{"name":"page","required":false,"in":"query","description":"Page number for pagination (starts from 1)","schema":{"minimum":1,"default":1,"example":1,"type":"integer"}},{"name":"limit","required":false,"in":"query","description":"Number of items per page (maximum 100)","schema":{"minimum":1,"maximum":100,"default":10,"example":10,"type":"integer"}},{"name":"search","required":false,"in":"query","description":"Search term to filter results","schema":{"type":"string"}},{"name":"orderBy","required":false,"in":"query","description":"Field to sort by","schema":{"type":"string"}},{"name":"order","required":false,"in":"query","description":"Sort order","schema":{"example":"desc","type":"string","enum":["asc","desc"]}},{"name":"title","required":false,"in":"query","description":"Filter templates by title","schema":{"type":"string"}},{"name":"type","required":false,"in":"query","description":"Filter templates by type","schema":{"type":"string"}},{"name":"createdById","required":false,"in":"query","description":"Filter templates by creator ID","schema":{"type":"string"}},{"name":"domainId","required":false,"in":"query","description":"Filter templates by domain ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Templates retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000"},"title":{"type":"string","example":"Algebra Quiz Template"},"type":{"type":"string","example":"quiz"},"sequence":{"type":"string","example":"1,2,3"},"colorCode":{"type":"string","example":"#FF5733"},"createdById":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000"},"questionCount":{"type":"number","example":10},"publishedQuestionCount":{"type":"number","example":8},"createdAt":{"type":"string","example":"2024-01-15T10:30:00.000Z"},"updatedAt":{"type":"string","example":"2024-01-15T10:30:00.000Z"}}}},"meta":{"type":"object","properties":{"total":{"type":"number","example":150},"page":{"type":"number","example":1},"limit":{"type":"number","example":10},"totalPages":{"type":"number","example":15}}}}}}}},"401":{"description":"Authentication required"},"403":{"description":"Insufficient permissions"}},"security":[{"bearer":[]}],"summary":"Get all templates","tags":["Templates"]}},"/api/v1/templates/{id}":{"get":{"description":"Retrieve a specific template with its questions.","operationId":"TemplateController_findById","parameters":[{"name":"id","required":true,"in":"path","description":"Template ID (UUID)","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}}],"responses":{"200":{"description":"Template retrieved successfully"},"404":{"description":"Template not found"}},"security":[{"bearer":[]}],"summary":"Get template by ID","tags":["Templates"]}},"/api/v1/grades":{"get":{"description":"Retrieve a list of all grades with optional filtering and search.","operationId":"GradeController_findAll","parameters":[{"name":"name","required":false,"in":"query","description":"Filter grades by name","schema":{"example":"Grade 5","type":"string"}},{"name":"search","required":false,"in":"query","description":"Search term to filter grades","schema":{"example":"kindergarten","type":"string"}},{"name":"isPureGrade","required":false,"in":"query","description":"Filter by pure grade status","schema":{"example":true,"type":"boolean"}}],"responses":{"200":{"description":"Grades retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000"},"name":{"type":"string","example":"Grade 5"},"isPureGrade":{"type":"boolean","example":true},"order":{"type":"number","example":5},"userCount":{"type":"number","example":150},"dropCount":{"type":"number","example":25},"responseCount":{"type":"number","example":1200}}}},"total":{"type":"number","example":12}}}}}},"401":{"description":"Authentication required"},"403":{"description":"Insufficient permissions"}},"security":[{"bearer":[]}],"summary":"Get all grades","tags":["Grades"]}},"/api/v1/grades/{id}":{"get":{"description":"Retrieve a specific grade with statistics.","operationId":"GradeController_findById","parameters":[{"name":"id","required":true,"in":"path","description":"Grade ID (UUID)","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}}],"responses":{"200":{"description":"Grade retrieved successfully"},"404":{"description":"Grade not found"}},"security":[{"bearer":[]}],"summary":"Get grade by ID","tags":["Grades"]}},"/api/v1/schools":{"get":{"description":"Retrieve a paginated list of schools with optional filtering and search.","operationId":"SchoolController_findAll","parameters":[{"name":"page","required":false,"in":"query","description":"Page number for pagination (starts from 1)","schema":{"minimum":1,"default":1,"example":1,"type":"integer"}},{"name":"limit","required":false,"in":"query","description":"Number of items per page (maximum 100)","schema":{"minimum":1,"maximum":100,"default":10,"example":10,"type":"integer"}},{"name":"search","required":false,"in":"query","description":"Search term to filter results","schema":{"type":"string"}},{"name":"orderBy","required":false,"in":"query","description":"Field to sort by","schema":{"type":"string"}},{"name":"order","required":false,"in":"query","description":"Sort order","schema":{"example":"desc","type":"string","enum":["asc","desc"]}},{"name":"name","required":false,"in":"query","description":"Filter schools by name","schema":{"type":"string"}},{"name":"state","required":false,"in":"query","description":"Filter schools by state","schema":{"type":"string"}},{"name":"city","required":false,"in":"query","description":"Filter schools by city","schema":{"type":"string"}},{"name":"schoolType","required":false,"in":"query","description":"Filter schools by school type","schema":{"type":"string"}},{"name":"isPrivate","required":false,"in":"query","description":"Filter by private school status","schema":{"type":"boolean"}},{"name":"zipCode","required":false,"in":"query","description":"Filter schools by zip code","schema":{"type":"string"}}],"responses":{"200":{"description":"Schools retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000"},"name":{"type":"string","example":"Lincoln Elementary School"},"city":{"type":"string","example":"Los Angeles"},"state":{"type":"string","example":"California"},"schoolType":{"type":"string","example":"Elementary"},"isPrivate":{"type":"boolean","example":false},"zipCode":{"type":"string","example":"90210"},"dropCount":{"type":"number","example":15},"createdAt":{"type":"string","example":"2024-01-15T10:30:00.000Z"},"updatedAt":{"type":"string","example":"2024-01-15T10:30:00.000Z"}}}},"meta":{"type":"object","properties":{"total":{"type":"number","example":500},"page":{"type":"number","example":1},"limit":{"type":"number","example":10},"totalPages":{"type":"number","example":50}}}}}}}},"401":{"description":"Authentication required"},"403":{"description":"Insufficient permissions"}},"security":[{"bearer":[]}],"summary":"Get all schools","tags":["Schools"]}},"/api/v1/schools/{id}":{"get":{"description":"Retrieve a specific school with statistics.","operationId":"SchoolController_findById","parameters":[{"name":"id","required":true,"in":"path","description":"School ID (UUID)","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}}],"responses":{"200":{"description":"School retrieved successfully"},"404":{"description":"School not found"}},"security":[{"bearer":[]}],"summary":"Get school by ID","tags":["Schools"]}},"/api/v1/questions":{"get":{"description":"Retrieve a paginated list of questions with optional filtering and search.","operationId":"QuestionController_findAll","parameters":[{"name":"page","required":false,"in":"query","description":"Page number for pagination (starts from 1)","schema":{"minimum":1,"default":1,"example":1,"type":"integer"}},{"name":"limit","required":false,"in":"query","description":"Number of items per page (maximum 100)","schema":{"minimum":1,"maximum":100,"default":10,"example":10,"type":"integer"}},{"name":"search","required":false,"in":"query","description":"Search term to filter results","schema":{"type":"string"}},{"name":"orderBy","required":false,"in":"query","description":"Field to sort by","schema":{"type":"string"}},{"name":"order","required":false,"in":"query","description":"Sort order","schema":{"example":"desc","type":"string","enum":["asc","desc"]}},{"name":"templateId","required":false,"in":"query","description":"Filter questions by template ID","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}},{"name":"level","required":false,"in":"query","description":"Filter questions by level","schema":{"example":"MEDIUM","type":"string","enum":["EASY","MEDIUM","HARD"]}},{"name":"status","required":false,"in":"query","description":"Filter questions by status","schema":{"example":"READY","type":"string","enum":["CURATION_FAILED","CURATION_PASSED","READY","CURATING","CREATED","PUBLISH"]}},{"name":"type","required":false,"in":"query","description":"Filter questions by type","schema":{"example":"multiple_choice","type":"string"}},{"name":"createdById","required":false,"in":"query","description":"Filter questions by creator ID","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}},{"name":"isPublished","required":false,"in":"query","description":"Filter by published status","schema":{"example":true,"type":"boolean"}},{"name":"curated","required":false,"in":"query","description":"Filter by curated status","schema":{"example":true,"type":"boolean"}}],"responses":{"200":{"description":"Questions retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000"},"question":{"type":"string","example":"What is 2 + 2?"},"answer":{"type":"string","example":"A"},"optionA":{"type":"string","example":"4"},"optionB":{"type":"string","example":"3"},"optionC":{"type":"string","example":"5"},"optionD":{"type":"string","example":"6"},"level":{"type":"string","enum":["EASY","MEDIUM","HARD"],"example":"EASY"},"status":{"type":"string","enum":["CURATION_FAILED","CURATION_PASSED","READY","CURATING","CREATED","PUBLISH"],"example":"READY"},"isPublished":{"type":"boolean","example":true},"curated":{"type":"boolean","example":true},"template":{"type":"object","properties":{"id":{"type":"string"},"title":{"type":"string"},"type":{"type":"string"}}},"createdBy":{"type":"object","properties":{"id":{"type":"string"},"email":{"type":"string"},"firstName":{"type":"string"},"lastName":{"type":"string"}}},"createdAt":{"type":"string","example":"2024-01-15T10:30:00.000Z"},"updatedAt":{"type":"string","example":"2024-01-15T10:30:00.000Z"}}}},"meta":{"type":"object","properties":{"total":{"type":"number","example":500},"page":{"type":"number","example":1},"limit":{"type":"number","example":10},"totalPages":{"type":"number","example":50}}}}}}}},"401":{"description":"Authentication required"},"403":{"description":"Insufficient permissions"}},"security":[{"bearer":[]}],"summary":"Get all questions","tags":["Questions"]}},"/api/v1/questions/{id}":{"get":{"description":"Retrieve a specific question with template and creator details.","operationId":"QuestionController_findById","parameters":[{"name":"id","required":true,"in":"path","description":"Question ID (UUID)","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}}],"responses":{"200":{"description":"Question retrieved successfully"},"404":{"description":"Question not found"}},"security":[{"bearer":[]}],"summary":"Get question by ID","tags":["Questions"]}},"/api/v1/topics":{"get":{"description":"Retrieve a list of all topics with optional filtering and search.","operationId":"TopicController_findAll","parameters":[{"name":"name","required":false,"in":"query","description":"Filter topics by name","schema":{"example":"","type":"string"}},{"name":"search","required":false,"in":"query","description":"Search term to filter topics","schema":{"example":"","type":"string"}},{"name":"isFunTopic","required":false,"in":"query","description":"Filter by fun topic status","schema":{"example":true,"type":"boolean"}}],"responses":{"200":{"description":"Topics retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000"},"name":{"type":"string","example":"Mathematics"},"isFunTopic":{"type":"boolean","example":false}}}},"total":{"type":"number","example":25}}}}}},"401":{"description":"Authentication required"},"403":{"description":"Insufficient permissions"}},"security":[{"bearer":[]}],"summary":"Get all topics","tags":["Topics"]}}},"info":{"title":"G3MS Drop App Backend API","description":"A modern user management and onboarding API built with NestJS, Prisma ORM, and Supabase Auth. Features role-based access control, multi-step onboarding flow, and comprehensive authentication.","version":"1.0","contact":{"name":"G3MS Team","url":"https://g3ms.com","email":"support@g3ms.com"},"license":{"name":"MIT","url":"https://opensource.org/licenses/MIT"}},"tags":[{"name":"Authentication","description":"User authentication endpoints"},{"name":"Users","description":"User management endpoints"},{"name":"Onboarding","description":"User onboarding flow endpoints"}],"servers":[{"url":"https://g3ms-dropapp-dev-820977213107.us-central1.run.app","description":"Production server"},{"url":"http://localhost:3000","description":"Development server"}],"components":{"securitySchemes":{"bearer":{"scheme":"bearer","bearerFormat":"JWT","type":"http"}},"schemas":{"RegisterDto":{"type":"object","properties":{"email":{"type":"string","description":"User email address","example":"john.doe@example.com","format":"email"},"password":{"type":"string","description":"User password - minimum 8 characters","example":"SecurePassword123!","minLength":8,"format":"password"}},"required":["email","password"]},"LoginDto":{"type":"object","properties":{"email":{"type":"string","description":"User email address for authentication","example":"john.doe@example.com","format":"email"},"password":{"type":"string","description":"User password for authentication","example":"SecurePassword123!","format":"password"}},"required":["email","password"]},"RefreshTokenDto":{"type":"object","properties":{"refreshToken":{"type":"string","description":"Refresh token for getting new access token","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."}},"required":["refreshToken"]},"GoogleAuthUrlDto":{"type":"object","properties":{"redirectTo":{"type":"string","description":"Redirect URL after Google OAuth completion","example":"http://localhost:3000/auth/callback"}},"required":["redirectTo"]},"GoogleAuthDto":{"type":"object","properties":{"accessToken":{"type":"string","description":"Google OAuth access token received from client","example":"ya29.a0AfH6SMC..."}},"required":["accessToken"]},"AppleAuthUrlDto":{"type":"object","properties":{"redirectTo":{"type":"string","description":"Redirect URL after Apple OAuth completion","example":"http://localhost:3000/auth/callback"}},"required":["redirectTo"]},"AppleAuthDto":{"type":"object","properties":{"accessToken":{"type":"string","description":"Apple OAuth access token received from client","example":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9..."}},"required":["accessToken"]},"ClassLinkAuthUrlDto":{"type":"object","properties":{"redirectTo":{"type":"string","description":"Redirect URL after ClassLink OAuth completion","example":"http://localhost:3000/auth/callback"}},"required":["redirectTo"]},"ClassLinkAuthDto":{"type":"object","properties":{"accessToken":{"type":"string","description":"ClassLink OAuth access token received from client","example":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9..."}},"required":["accessToken"]},"CompleteUploadDto":{"type":"object","properties":{"uploadId":{"type":"string","description":"Mux upload ID returned after successful upload","example":"upload_123456789"},"title":{"type":"string","description":"Optional title for the video","example":"Introduction to Algebra","maxLength":200}},"required":["uploadId"]},"CreateDropRewardDto":{"type":"object","properties":{"rewardType":{"type":"string","enum":["G3MS","BRAND_REWARD"],"description":"Type of reward - G3MS tokens or brand-specific reward item","example":"G3MS"},"g3msAmount":{"type":"number","description":"Amount of G3MS tokens to award. Required if rewardType is G3MS.","example":100,"minimum":1},"rewardItemId":{"type":"string","description":"ID of the StoreItem to award. Required if rewardType is BRAND_REWARD.","example":"123e4567-e89b-12d3-a456-426614174000"},"winnersCount":{"type":"number","description":"Number of top performers to receive the reward.","example":5,"minimum":1},"eligibilityText":{"type":"string","description":"Public description of reward eligibility criteria.","example":"Top 5 students with highest quiz scores","maxLength":500}},"required":["rewardType","winnersCount","eligibilityText"]},"CreateDropDto":{"type":"object","properties":{"title":{"type":"string","description":"Title of the Drop - should be engaging and descriptive","example":"Advanced Algebra: Quadratic Equations Mastery","maxLength":200},"dropType":{"type":"string","enum":["BELLWORK_EXIT_TICKETS","KNOWLEDGE_CHECK_QUIZ","SCAFFOLDED_LESSON","VIDEO_BASED_INSTRUCTION","PROJECT_BASED_LEARNING","FORMATIVE_ASSESSMENT"],"description":"Type of drop that determines completion method and student interaction","example":"KNOWLEDGE_CHECK_QUIZ"},"topicId":{"type":"string","description":"Academic subject area for the drop","example":"MATH01","maxLength":100},"rtiTier":{"type":"string","description":"Response to Intervention (RTI) tier level","example":"ONE","enum":["ONE","TWO","THREE"]},"learningGoal":{"type":"string","description":"Specific learning objective or goal for this drop","example":"Students will solve quadratic equations using the quadratic formula","maxLength":1000},"scheduledAt":{"format":"date-time","type":"string","description":"Scheduled date and time for the drop to go live (ISO 8601 format). Must be in the future.","example":"2025-08-26T08:37:11.151Z"},"videoId":{"type":"string","description":"ID of the pre-uploaded video content for the drop","example":"07de672f-b69f-4085-89b6-ae80800d51d9"},"uploadId":{"type":"string","description":"Mux upload ID for new video upload. Either videoId or uploadId must be provided, but not both.","example":"upload_123456789"},"templateId":{"type":"string","description":"ID of the quiz template containing questions for the drop","example":"tmp8spa22"},"schoolIds":{"description":"Array of School IDs to target. Leave empty for all schools.","example":["120DEMOSCHOOL"],"type":"array","items":{"type":"string"}},"gradeIds":{"description":"Array of Grade IDs to target. Leave empty for all grades.","example":["GRADE1","GRADE2","GRADE3","GRADE4","GRADE5","GRADE6","GRADE7","GRADE8","GRADE9","GRADE10","GRADE11","GRADE12"],"type":"array","items":{"type":"string"}},"brandId":{"type":"string","description":"Brand ID for brand-sponsored drops. Links to the Brand model.","example":"123e4567-e89b-12d3-a456-426614174000"},"reward":{"description":"Reward configuration for successful drop completion","allOf":[{"$ref":"#/components/schemas/CreateDropRewardDto"}]}},"required":["title","dropType","scheduledAt","videoId","templateId","reward"]},"UpdateDropDto":{"type":"object","properties":{"title":{"type":"string","description":"Title of the Drop - should be engaging and descriptive","example":"Advanced Algebra: Quadratic Equations Mastery","maxLength":200},"dropType":{"type":"string","enum":["BELLWORK_EXIT_TICKETS","KNOWLEDGE_CHECK_QUIZ","SCAFFOLDED_LESSON","VIDEO_BASED_INSTRUCTION","PROJECT_BASED_LEARNING","FORMATIVE_ASSESSMENT"],"description":"Type of drop that determines completion method and student interaction","example":"KNOWLEDGE_CHECK_QUIZ"},"topicId":{"type":"string","description":"Academic subject area for the drop","example":"MATH01","maxLength":100},"rtiTier":{"type":"string","description":"Response to Intervention (RTI) tier level","example":"ONE","enum":["ONE","TWO","THREE"]},"learningGoal":{"type":"string","description":"Specific learning objective or goal for this drop","example":"Students will solve quadratic equations using the quadratic formula","maxLength":1000},"scheduledAt":{"format":"date-time","type":"string","description":"Scheduled date and time for the drop to go live (ISO 8601 format). Must be in the future.","example":"2025-08-26T08:37:11.151Z"},"videoId":{"type":"string","description":"ID of the pre-uploaded video content for the drop","example":"07de672f-b69f-4085-89b6-ae80800d51d9"},"uploadId":{"type":"string","description":"Mux upload ID for new video upload. Either videoId or uploadId must be provided, but not both.","example":"upload_123456789"},"templateId":{"type":"string","description":"ID of the quiz template containing questions for the drop","example":"tmp8spa22"},"schoolIds":{"description":"Array of School IDs to target. Leave empty for all schools.","example":["120DEMOSCHOOL"],"type":"array","items":{"type":"string"}},"gradeIds":{"description":"Array of Grade IDs to target. Leave empty for all grades.","example":["GRADE1","GRADE2","GRADE3","GRADE4","GRADE5","GRADE6","GRADE7","GRADE8","GRADE9","GRADE10","GRADE11","GRADE12"],"type":"array","items":{"type":"string"}},"brandId":{"type":"string","description":"Brand ID for brand-sponsored drops. Links to the Brand model.","example":"123e4567-e89b-12d3-a456-426614174000"},"reward":{"description":"Reward configuration for successful drop completion","allOf":[{"$ref":"#/components/schemas/CreateDropRewardDto"}]}}},"PublishDropDto":{"type":"object","properties":{"isPublished":{"type":"boolean","description":"Whether to publish the drop (make it visible to students)","example":true}},"required":["isPublished"]},"CreateMediaResponseDto":{"type":"object","properties":{"responseType":{"type":"string","enum":["VIDEO","IMAGE","AUDIO_NOTE","TEXT"],"description":"Type of media response being submitted","example":"VIDEO"},"contentUrl":{"type":"string","description":"URL for image or audio responses (pre-uploaded to storage)","example":"https://storage.example.com/responses/image123.jpg"},"uploadId":{"type":"string","description":"Mux upload ID for new video uploads","example":"upload_123456789"},"videoId":{"type":"string","description":"ID of existing video from user library","example":"123e4567-e89b-12d3-a456-426614174000"},"textResponse":{"type":"string","description":"Text content for text-based responses","example":"This is my thoughtful response to the drop question...","maxLength":2000}},"required":["responseType"]},"SubmitQuizAnswerDto":{"type":"object","properties":{"quizSessionId":{"type":"string","description":"ID of the active quiz session","example":"123e4567-e89b-12d3-a456-426614174000"},"questionId":{"type":"string","description":"ID of the question being answered","example":"123e4567-e89b-12d3-a456-426614174000"},"answer":{"type":"string","description":"Selected answer option (A, B, C, or D)","example":"A","pattern":"^[ABCD]$"}},"required":["quizSessionId","questionId","answer"]},"RoleSelectionDto":{"type":"object","properties":{"role":{"type":"string","description":"User role selection","enum":["student","educator","brand","creator","ambassador","parent","super_admin"],"example":"student"}},"required":["role"]},"BirthdateDto":{"type":"object","properties":{"birthDate":{"type":"string","description":"Student birthdate in YYYY-MM-DD format","example":"2010-05-15","pattern":"^\\d{4}-\\d{2}-\\d{2}$"}},"required":["birthDate"]},"SendOtpDto":{"type":"object","properties":{"phoneE164":{"type":"string","description":"Phone number in E.164 format","example":"+1234567890","pattern":"^\\+[1-9]\\d{1,14}$"}},"required":["phoneE164"]},"VerifyOtpDto":{"type":"object","properties":{"phoneE164":{"type":"string","description":"Phone number in E.164 format","example":"+1234567890","pattern":"^\\+[1-9]\\d{1,14}$"},"code":{"type":"string","description":"OTP code (6 digits)","example":"123456","minLength":6,"maxLength":6}},"required":["phoneE164","code"]},"GuardianApprovalDto":{"type":"object","properties":{"studentFirstName":{"type":"string","description":"Student first name","example":"John","minLength":2,"maxLength":50},"studentLastName":{"type":"string","description":"Student last name","example":"Doe","minLength":2,"maxLength":50},"parentFirstName":{"type":"string","description":"Parent first name","example":"Jane","minLength":2,"maxLength":50},"parentLastName":{"type":"string","description":"Parent last name","example":"Doe","minLength":2,"maxLength":50},"parentPhone":{"type":"string","description":"Parent phone number in E.164 format","example":"+1234567890","pattern":"^\\+[1-9]\\d{1,14}$"}},"required":["studentFirstName","studentLastName","parentFirstName","parentLastName","parentPhone"]}}}}